<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shrouded Sails</title>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <div class="game-container">
        <header class="game-header" id="gameHeader">
            <h1 class="game-title">Shrouded Sails</h1>
            <div class="header-info">
                <div class="header-zone header-zone-left">
                    <span id="turnInfo" class="header-pill">Turn: 1</span>
                    <span id="playerInfo" class="header-pill">Player: 1</span>
                </div>
                <div class="header-zone header-zone-center">
                    <div class="wind-widget" aria-label="Wind status">
                        <div class="wind-compass" aria-hidden="true">
                            <span id="windDirectionArrow" class="wind-direction-arrow">â†‘</span>
                        </div>
                        <div class="wind-meta">
                            <span class="wind-label">Wind</span>
                            <div class="wind-values">
                                <span id="windDirectionName">N</span>
                                <span class="wind-separator">â€¢</span>
                                <span>Str <span id="windStrengthValue">0</span></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="header-zone header-zone-right">
                    <button
                        id="mobileHeaderToggle"
                        class="mobile-ui-toggle mobile-ui-toggle-header"
                        type="button"
                        aria-expanded="true"
                        aria-controls="gameHeader"
                    >
                        Hide Top
                    </button>
                    <button id="combatFeedButton" class="combat-feed-button" type="button" aria-expanded="false" aria-controls="combatFeedPanel">
                        <span id="combatFeedStatusIcon" class="combat-feed-status-icon">ðŸ§­</span>
                        <span class="combat-feed-text">
                            <span class="combat-feed-title">Combat Feed</span>
                            <span id="combatFeedStatusText" class="combat-feed-status-text">Quiet seas</span>
                        </span>
                        <span id="combatFeedUnread" class="combat-feed-unread hidden">0</span>
                    </button>
                    <button id="inGameSettingsButton" class="in-game-settings-button" type="button"
                            aria-expanded="false" aria-controls="inGameSettingsPanel" title="Audio Settings">
                        <span class="in-game-settings-icon" aria-hidden="true">&#9881;</span>
                    </button>
                </div>
            </div>
        </header>

        <div class="game-board">
            <!-- Player 1 Ships Panel (Left) -->
            <aside class="ships-panel ships-panel-left">
                <h3>Red Fleet</h3>
                <div id="player1Ships" class="ships-list"></div>
            </aside>

            <div class="battlefield-column">
                <!-- Game Canvas -->
                <div class="canvas-container">
                    <canvas id="gameCanvas"></canvas>
                </div>
            </div>

            <!-- Player 2 Ships Panel (Right) -->
            <aside class="ships-panel ships-panel-right">
                <h3>Blue Fleet</h3>
                <div id="player2Ships" class="ships-list"></div>
            </aside>
        </div>

        <footer class="game-footer" id="gameFooter">
            <div class="footer-top-row">
                <div class="ship-info">
                    <span id="selectedShipInfo">No ship selected</span>
                </div>
                <button
                    id="mobileFooterToggle"
                    class="mobile-ui-toggle mobile-ui-toggle-footer"
                    type="button"
                    aria-expanded="true"
                    aria-controls="gameFooter"
                >
                    Hide Actions
                </button>
            </div>
            <div class="action-buttons">
                <button id="moveBtn" class="action-btn" disabled>Move</button>
                <button id="fireBtn" class="action-btn" disabled>Fire Cannons</button>
                <button id="boardBtn" class="action-btn" disabled>Board Enemy</button>
                <button id="endTurnBtn" class="action-btn primary">End Turn</button>
            </div>
        </footer>
    </div>

    <!-- Splash Modal -->
    <div
        id="splashModal"
        class="modal splash-modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="splashTitle"
        aria-describedby="splashDescription"
    >
        <div class="modal-content splash-modal-content">
            <h2 id="splashTitle">Shrouded Sails</h2>
            <p id="splashDescription" class="splash-tagline">Chart the fog. Command your fleet.</p>
            <p class="splash-hint">Click anywhere to continue</p>
            <button id="continueFromSplashBtn" class="action-btn primary splash-continue-btn" type="button">
                Continue
            </button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div
        id="settingsModal"
        class="modal hidden"
        role="dialog"
        aria-modal="true"
        aria-labelledby="settingsTitle"
    >
        <div class="modal-content settings-modal">
            <h2 id="settingsTitle">Game Settings</h2>
            <div class="settings-section">
                <div class="setting-item">
                    <label for="fogOfWarCheckbox" class="setting-label">
                        <input type="checkbox" id="fogOfWarCheckbox" checked>
                        <span class="setting-title">Fog of War</span>
                    </label>
                    <p class="setting-description">
                        Enable tactical mode with limited visibility. Enemy ships are only visible within your fleet's vision range.
                        Larger ships have better vision (Flagship=4, Frigate=3, Sloop=2).
                    </p>
                </div>
                <div class="setting-item">
                    <label for="combatDetailLevelSelect" class="setting-label">
                        <span class="setting-title">Combat Report Detail</span>
                    </label>
                    <p class="setting-description">
                        Detailed shows full per-cannon combat reports. Compact shows brief summaries in the feed.
                    </p>
                    <select id="combatDetailLevelSelect" class="setting-select">
                        <option value="detailed" selected>Detailed</option>
                        <option value="compact">Compact</option>
                    </select>
                </div>
                <div class="setting-item">
                    <label for="muteAllCheckbox" class="setting-label">
                        <input type="checkbox" id="muteAllCheckbox">
                        <span class="setting-title">Mute All Audio</span>
                    </label>
                    <p class="setting-description">
                        Mutes all game audio when enabled. Use the sliders below for volume control when unmuted.
                    </p>
                    <div class="audio-controls">
                        <div class="audio-control-row">
                            <label for="masterVolumeSlider" class="audio-control-label">Master Volume</label>
                            <span id="masterVolumeValue" class="audio-control-value">70%</span>
                            <input type="range" id="masterVolumeSlider" min="0" max="100" step="1" value="70" class="audio-slider">
                        </div>
                        <div class="audio-control-row">
                            <label for="effectsVolumeSlider" class="audio-control-label">Effects Volume</label>
                            <span id="effectsVolumeValue" class="audio-control-value">80%</span>
                            <input type="range" id="effectsVolumeSlider" min="0" max="100" step="1" value="80" class="audio-slider">
                        </div>
                        <div class="audio-control-row">
                            <label for="uiVolumeSlider" class="audio-control-label">UI Volume</label>
                            <span id="uiVolumeValue" class="audio-control-value">70%</span>
                            <input type="range" id="uiVolumeSlider" min="0" max="100" step="1" value="70" class="audio-slider">
                        </div>
                        <div class="audio-control-row">
                            <label for="musicVolumeSlider" class="audio-control-label">Music Volume</label>
                            <span id="musicVolumeValue" class="audio-control-value">50%</span>
                            <input type="range" id="musicVolumeSlider" min="0" max="100" step="1" value="50" class="audio-slider">
                        </div>
                    </div>
                </div>
            </div>
            <div class="settings-actions">
                <button id="startGameBtn" class="action-btn primary" type="button">Start Game</button>
                <button id="startTutorialBtn" class="action-btn" type="button">Start with Tutorial</button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal hidden">
        <div class="modal-content">
            <h2 id="gameOverTitle">Game Over!</h2>
            <p id="gameOverMessage"></p>
            <button id="restartBtn" class="action-btn primary">Play Again</button>
        </div>
    </div>

    <!-- Turn Transition Modal -->
    <div id="turnTransitionModal" class="modal hidden">
        <div class="modal-content turn-transition">
            <h2 id="turnTransitionTitle">Player 2's Turn</h2>
            <p id="turnTransitionMessage">Pass the device to the other player</p>
            <button id="startTurnBtn" class="action-btn primary large">Click to Start Turn</button>
        </div>
    </div>

    <div id="combatFeedBackdrop" class="combat-feed-backdrop hidden"></div>
    <aside id="combatFeedPanel" class="combat-feed-panel hidden" aria-label="Combat Feed">
        <div class="combat-feed-panel-header">
            <h3>Combat Feed</h3>
            <button id="combatFeedClose" class="combat-feed-close" type="button" aria-label="Close combat feed">Close</button>
        </div>
        <p class="combat-feed-panel-subtitle">Newest events first. Click an entry to expand details.</p>
        <div id="combatLogEmpty" class="combat-log-empty">No combat yet. Fire cannons or board an enemy ship to create entries.</div>
        <div id="combatLogList" class="combat-log-list"></div>
    </aside>

    <div id="inGameSettingsBackdrop" class="in-game-settings-backdrop hidden"></div>
    <aside id="inGameSettingsPanel" class="in-game-settings-panel hidden" aria-label="Audio Settings">
        <div class="in-game-settings-panel-header">
            <h3>Audio Settings</h3>
            <button id="inGameSettingsClose" class="in-game-settings-close" type="button" aria-label="Close audio settings">Close</button>
        </div>
        <div class="in-game-settings-body">
            <div class="setting-item">
                <label for="igMuteAllCheckbox" class="setting-label">
                    <input type="checkbox" id="igMuteAllCheckbox">
                    <span class="setting-title">Mute All</span>
                </label>
            </div>
            <div class="setting-item">
                <div class="audio-controls">
                    <div class="audio-control-row">
                        <label for="igMasterVolumeSlider" class="audio-control-label">Master Volume</label>
                        <span id="igMasterVolumeValue" class="audio-control-value">70%</span>
                        <input type="range" id="igMasterVolumeSlider" min="0" max="100" step="1" value="70" class="audio-slider">
                    </div>
                    <div class="audio-control-row">
                        <label for="igEffectsVolumeSlider" class="audio-control-label">Effects Volume</label>
                        <span id="igEffectsVolumeValue" class="audio-control-value">80%</span>
                        <input type="range" id="igEffectsVolumeSlider" min="0" max="100" step="1" value="80" class="audio-slider">
                    </div>
                    <div class="audio-control-row">
                        <label for="igUiVolumeSlider" class="audio-control-label">UI Volume</label>
                        <span id="igUiVolumeValue" class="audio-control-value">70%</span>
                        <input type="range" id="igUiVolumeSlider" min="0" max="100" step="1" value="70" class="audio-slider">
                    </div>
                    <div class="audio-control-row">
                        <label for="igMusicVolumeSlider" class="audio-control-label">Music Volume</label>
                        <span id="igMusicVolumeValue" class="audio-control-value">50%</span>
                        <input type="range" id="igMusicVolumeSlider" min="0" max="100" step="1" value="50" class="audio-slider">
                    </div>
                </div>
            </div>
        </div>
    </aside>

    <script type="module" src="./src/main.js"></script>
</body>
</html>
